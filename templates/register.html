{% extends "base.html" %}
{% block title %}Register{% endblock %}
{% block content %}
<div style="max-width:400px; margin:50px auto; padding:20px; border:1px solid #ccc; border-radius:8px; background:#fff;">
  <h2 style="text-align:center; margin-bottom:20px;">Register</h2>
  <form id="register-form">
    <div style="margin-bottom:15px;">
      <label>Username:</label><br>
      <input type="text" id="username" style="width:100%; padding:8px; border:1px solid #aaa; border-radius:4px;" required>
    </div>
    <div style="margin-bottom:15px;">
      <label>Email:</label><br>
      <input type="email" id="email" style="width:100%; padding:8px; border:1px solid #aaa; border-radius:4px;" required>
    </div>
    <div style="margin-bottom:20px;">
      <label>Password:</label><br>
      <input type="password" id="password" style="width:100%; padding:8px; border:1px solid #aaa; border-radius:4px;" required>
    </div>
    <button type="submit" style="width:100%; padding:10px; border:none; border-radius:4px; background:#4CAF50; color:white;">Register</button>
  </form>
</div>

<script>
document.getElementById('register-form').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const username = document.getElementById('username').value;
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;

  try {
    await axios.post('/api/auth/register/', { username, email, password });
    alert('Registration successful');
    window.location = '/login/';
  } catch (err) {
    if (err.response) {
      let message = '';
      for (let key in err.response.data) message += `${key}: ${err.response.data[key]}\n`;
      alert(`Registration failed:\n${message}`);
    } else if (err.request) {
      alert('No response from server.');
    } else {
      alert(`Error: ${err.message}`);
    }
  }
});
</script>
{% endblock %}
